<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Amber Flow é ç´„ç³»çµ± (Demo)</title>
    
    <!-- 1. å¼•å…¥ Tailwind CSS (ç¾åŒ–æ¨£å¼) -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- 2. å¼•å…¥ React å’Œ ReactDOM (æ ¸å¿ƒå¼•æ“) -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    
    <!-- 3. å¼•å…¥ Babel (è®“ç€è¦½å™¨çœ‹ä¸æ‡‚çš„ JSX è½‰æˆçœ‹å¾—æ‡‚çš„ JS) -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <!-- 4. å¼•å…¥åœ–æ¨™åº« (Lucide Icons) -->
    <script src="https://unpkg.com/lucide@latest"></script>

    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;500;700&display=swap');
        body { font-family: 'Noto Sans TC', sans-serif; }
        .custom-scrollbar::-webkit-scrollbar { width: 6px; }
        .custom-scrollbar::-webkit-scrollbar-thumb { background-color: #cbd5e1; border-radius: 3px; }
        @keyframes fade-in-up {
            0% { opacity: 0; transform: translateY(10px); }
            100% { opacity: 1; transform: translateY(0); }
        }
        .animate-fade-in-up { animation: fade-in-up 0.5s ease-out forwards; }
    </style>
</head>
<body class="bg-slate-100 text-slate-800">

    <!-- é€™æ˜¯ React ç¨‹å¼æ›è¼‰çš„æ ¹ç›®éŒ„ -->
    <div id="root"></div>

    <!-- é€™è£¡æ˜¯ React ç¨‹å¼ç¢¼é‚è¼¯ -->
    <script type="text/babel">
        const { useState, useEffect, useRef } = React;

        // --- æ¨¡æ“¬è³‡æ–™åº« (æ”¹ç‚ºç‘œçˆ/çš®æ‹‰ææ–¯ä¸»é¡Œ) ---
        const STORE_INFO = {
            name: "ğŸ§˜â€â™€ï¸ Amber Flow ç‘œçˆç©ºé–“",
            address: "å°åŒ—å¸‚ä¸­å±±å€å—äº¬è¥¿è·¯ 88 è™Ÿ",
            description: "æ‰¾å›èº«é«”çš„æµå‹•èˆ‡å¹³è¡¡ï¼Œå°ˆå±¬æ–¼æ‚¨çš„èº«å¿ƒä¿®å¾©æ™‚å…‰ã€‚",
            lineUrl: "https://line.me/ti/p/@example",
            rating: 5.0
        };

        const SERVICES = [
            { id: 's1', name: 'å™¨æ¢°çš®æ‹‰ææ–¯ (Reformer)', duration: 60, price: 1200, description: '1å°1 æŒ‡å°ï¼Œå¼·åŒ–æ ¸å¿ƒè‚Œç¾¤èˆ‡é«”æ…‹é›•å¡‘ã€‚', tag: 'ç†±é–€' },
            { id: 's2', name: 'ç©ºä¸­ç‘œçˆ (Aerial Yoga)', duration: 60, price: 800, description: 'åˆ©ç”¨æ›å¸ƒå°æŠ—åœ°å¿ƒå¼•åŠ›ï¼Œèˆ’å±•è„Šæ¤èˆ‡å£“åŠ›ã€‚', tag: 'æ¨è–¦' },
            { id: 's3', name: 'åŸºç¤å“ˆé”ç‘œçˆ', duration: 75, price: 600, description: 'é©åˆåˆå­¸è€…ï¼Œé€éå‘¼å¸èˆ‡é«”ä½æ³•æ‰¾å›å¹³éœã€‚', tag: 'å…¥é–€' },
        ];

        const STAFF = [
            // é€™è£¡æŠŠ Amber æ”¾åœ¨ç¬¬ä¸€ä½
            { id: 'st1', name: 'Amber è€å¸«', title: 'å‰µè¾¦äºº / é¦–å¸­æ•™ç·´', avatar: 'https://api.dicebear.com/7.x/avataaars/svg?seed=Amber&hair=long&clothing=shirt', rating: 5.0 },
            { id: 'st2', name: 'Kelly æ•™ç·´', title: 'è³‡æ·±çš®æ‹‰ææ–¯æŒ‡å°', avatar: 'https://api.dicebear.com/7.x/avataaars/svg?seed=Kelly&hair=bob', rating: 4.9 },
            { id: 'st3', name: 'Leo è€å¸«', title: 'æµå‹•ç‘œçˆå¸«', avatar: 'https://api.dicebear.com/7.x/avataaars/svg?seed=Leo&facialHair=beard', rating: 4.8 },
        ];

        const TIME_SLOTS = ['09:30', '10:30', '14:00', '15:30', '18:30', '19:45', '20:30'];

        // --- ä¸»ç¨‹å¼å…ƒä»¶ ---
        function BookingApp() {
            const [step, setStep] = useState(1);
            const [selectedService, setSelectedService] = useState(null);
            const [selectedStaff, setSelectedStaff] = useState(null);
            const [selectedTime, setSelectedTime] = useState(null);
            const [customerInfo, setCustomerInfo] = useState({ name: '', phone: '' });
            const [error, setError] = useState('');

            // --- è™•ç†å‡½å¼ ---
            const handleServiceSelect = (service) => { setSelectedService(service); setStep(2); };
            const handleStaffSelect = (staff) => { setSelectedStaff(staff); setStep(3); };
            const handleTimeSelect = (time) => { setSelectedTime(time); setStep(4); };

            const handleConfirm = () => {
                const phoneRegex = /^09\d{8}$/;
                if (!phoneRegex.test(customerInfo.phone)) {
                    setError('è«‹è¼¸å…¥æ­£ç¢ºçš„ 09 é–‹é ­ 10 ç¢¼æ‰‹æ©Ÿè™Ÿç¢¼');
                    return;
                }
                setStep(5);
            };

            // --- ä¿®å¾©ç‰ˆåœ–æ¨™çµ„ä»¶ (è§£æ±º React ç™½å±å•é¡Œ) ---
            const Icon = ({ name, size = 20, className = "" }) => {
                const ref = useRef(null);
                
                useEffect(() => {
                    if (!ref.current || !window.lucide) return;
                    
                    const i = document.createElement('i');
                    i.setAttribute('data-lucide', name);
                    i.setAttribute('width', size);
                    i.setAttribute('height', size);
                    if (className) i.setAttribute('class', className);
                    
                    ref.current.innerHTML = '';
                    ref.current.appendChild(i);
                    
                    window.lucide.createIcons({
                        root: ref.current
                    });
                    
                }, [name, size, className]);

                return <span ref={ref} className="inline-flex items-center justify-center"></span>;
            };

            return (
                <div className="min-h-screen bg-gradient-to-br from-stone-50 to-emerald-50 flex justify-center p-4">
                    <div className="w-full max-w-md bg-white rounded-[32px] shadow-2xl flex flex-col overflow-hidden relative border border-white/50 h-[85vh]">
                        
                        {/* é ‚éƒ¨å°è¦½ */}
                        <header className="bg-white/80 backdrop-blur-md p-4 border-b border-stone-100 flex items-center sticky top-0 z-20">
                            {step > 1 && step < 5 && (
                                <button onClick={() => setStep(step - 1)} className="mr-2 p-2 rounded-full hover:bg-stone-100 transition-colors">
                                    <Icon name="chevron-left" />
                                </button>
                            )}
                            <div className="flex-1 text-center font-bold text-stone-700">
                                {step === 1 ? "é ç´„èª²ç¨‹" : step === 2 ? "é¸æ“‡æŒ‡å°è€å¸«" : step === 3 ? "é¸æ“‡æ™‚æ®µ" : step === 4 ? "ç¢ºèªè³‡æ–™" : "é ç´„å®Œæˆ"}
                            </div>
                            {step > 1 && step < 5 && <div className="w-10"></div>}
                        </header>

                        {/* é€²åº¦æ¢ */}
                        {step < 5 && (
                            <div className="w-full bg-stone-100 h-1">
                                <div className="bg-emerald-500 h-1 transition-all duration-500" style={{ width: `${(step / 4) * 100}%` }}></div>
                            </div>
                        )}

                        <main className="flex-1 p-5 overflow-y-auto custom-scrollbar">
                            
                            {/* STEP 1: æœå‹™ */}
                            {step === 1 && (
                                <div className="space-y-6 animate-fade-in-up">
                                    <div className="text-center py-4">
                                        <h1 className="text-2xl font-bold text-stone-800">{STORE_INFO.name}</h1>
                                        <p className="text-sm text-stone-500 mt-2 tracking-wide">{STORE_INFO.description}</p>
                                    </div>
                                    <div className="space-y-4">
                                        {SERVICES.map(service => (
                                            <div key={service.id} onClick={() => handleServiceSelect(service)} 
                                                className="bg-white border border-stone-100 rounded-2xl p-5 hover:border-emerald-400 hover:shadow-lg cursor-pointer transition-all active:scale-95 group">
                                                <div className="flex justify-between">
                                                    <div>
                                                        <h3 className="font-bold text-lg text-stone-800 group-hover:text-emerald-700">{service.name}</h3>
                                                        <p className="text-xs text-stone-400 mt-1">{service.description}</p>
                                                        <div className="flex items-center text-xs text-stone-400 mt-2 font-medium">
                                                            <span className="mr-1">ğŸ•’</span> {service.duration} åˆ†é˜
                                                        </div>
                                                    </div>
                                                    <span className="text-lg font-bold text-emerald-600 font-mono">${service.price}</span>
                                                </div>
                                            </div>
                                        ))}
                                    </div>
                                </div>
                            )}

                            {/* STEP 2: äººå“¡ */}
                            {step === 2 && (
                                <div className="space-y-4 animate-fade-in-up">
                                    <div className="bg-emerald-50 p-3 rounded-xl text-sm text-emerald-800 border border-emerald-100 flex justify-between">
                                        <span>èª²ç¨‹ï¼š{selectedService.name}</span>
                                        <span className="font-bold">${selectedService.price}</span>
                                    </div>
                                    <div onClick={() => handleStaffSelect({ id: 'any', name: 'ä¸æŒ‡å®šè€å¸«', avatar: '', isAny: true })}
                                        className="border border-dashed border-stone-300 rounded-2xl p-4 flex items-center hover:bg-emerald-50 cursor-pointer">
                                        <div className="w-12 h-12 bg-stone-100 rounded-full flex items-center justify-center mr-4 text-xl">ğŸ§˜</div>
                                        <div>
                                            <h3 className="font-bold text-stone-700">ä¸æŒ‡å®š (æœ€å¿«å¯ç´„)</h3>
                                            <p className="text-xs text-stone-400">ç”±ç³»çµ±å®‰æ’åˆé©æ•™ç·´</p>
                                        </div>
                                    </div>
                                    <div className="grid grid-cols-2 gap-3">
                                        {STAFF.map(staff => (
                                            <div key={staff.id} onClick={() => handleStaffSelect(staff)}
                                                className="border border-stone-100 rounded-2xl p-4 flex flex-col items-center hover:border-emerald-500 hover:shadow-md cursor-pointer bg-white group">
                                                <img src={staff.avatar} className="w-16 h-16 rounded-full mb-2 bg-stone-50 group-hover:scale-105 transition-transform" />
                                                <h3 className="font-bold text-stone-700">{staff.name}</h3>
                                                <span className="text-[10px] bg-stone-100 text-stone-500 px-2 py-1 rounded mt-1">{staff.title}</span>
                                            </div>
                                        ))}
                                    </div>
                                </div>
                            )}

                            {/* STEP 3: æ™‚é–“ */}
                            {step === 3 && (
                                <div className="animate-fade-in-up">
                                    <div className="flex space-x-2 mb-6 text-xs">
                                        <span className="bg-emerald-100 text-emerald-700 px-3 py-1 rounded-full">{selectedService.name}</span>
                                        <span className="bg-stone-100 text-stone-600 px-3 py-1 rounded-full">{selectedStaff.name}</span>
                                    </div>
                                    <h3 className="font-bold mb-4 flex items-center text-stone-700"><Icon name="calendar" size={16} className="mr-2"/> é¸æ“‡ä»Šæ—¥æ™‚æ®µ</h3>
                                    <div className="grid grid-cols-3 gap-3">
                                        {TIME_SLOTS.map(time => (
                                            <button key={time} onClick={() => handleTimeSelect(time)}
                                                className="py-3 border border-stone-200 rounded-xl hover:bg-emerald-600 hover:text-white hover:border-emerald-600 transition font-medium text-stone-600 active:scale-95">
                                                {time}
                                            </button>
                                        ))}
                                    </div>
                                </div>
                            )}

                            {/* STEP 4: è³‡æ–™ */}
                            {step === 4 && (
                                <div className="space-y-6 animate-fade-in-up">
                                    <div className="bg-white border border-stone-100 shadow-lg rounded-2xl overflow-hidden">
                                        <div className="bg-emerald-600 p-3 text-white font-bold text-center">é ç´„ç¢ºèª</div>
                                        <div className="p-5 space-y-3 text-sm">
                                            <div className="flex justify-between"><span className="text-stone-400">èª²ç¨‹</span><span className="font-medium text-stone-700">{selectedService.name}</span></div>
                                            <div className="flex justify-between"><span className="text-stone-400">è€å¸«</span><span className="font-medium text-stone-700">{selectedStaff.name}</span></div>
                                            <div className="flex justify-between"><span className="text-stone-400">æ™‚é–“</span><span className="font-bold text-emerald-600">ä»Šæ—¥ {selectedTime}</span></div>
                                            <div className="pt-3 border-t border-stone-100 flex justify-between items-center">
                                                <span className="text-stone-400">è²»ç”¨</span>
                                                <span className="text-xl font-bold text-stone-800">${selectedService.price}</span>
                                            </div>
                                        </div>
                                    </div>
                                    <div className="space-y-4">
                                        <div>
                                            <label className="block text-xs font-bold text-stone-400 mb-1 ml-1 uppercase">å§“å</label>
                                            <input type="text" placeholder="æ‚¨çš„ç¨±å‘¼" value={customerInfo.name} onChange={(e) => setCustomerInfo({...customerInfo, name: e.target.value})}
                                                className="w-full p-3 bg-stone-50 border border-stone-200 rounded-xl focus:ring-2 focus:ring-emerald-500 outline-none"/>
                                        </div>
                                        <div>
                                            <label className="block text-xs font-bold text-stone-400 mb-1 ml-1 uppercase">æ‰‹æ©Ÿ</label>
                                            <input type="tel" placeholder="09xx-xxx-xxx" value={customerInfo.phone} 
                                                onChange={(e) => { setCustomerInfo({...customerInfo, phone: e.target.value}); setError(''); }}
                                                className={`w-full p-3 bg-stone-50 border rounded-xl focus:ring-2 outline-none ${error ? 'border-red-500 bg-red-50' : 'border-stone-200 focus:ring-emerald-500'}`}/>
                                            {error && <p className="text-red-500 text-xs mt-1 ml-1">{error}</p>}
                                        </div>
                                    </div>
                                    <button onClick={handleConfirm} className="w-full bg-stone-800 text-white py-4 rounded-xl font-bold text-lg hover:bg-stone-900 shadow-xl active:scale-95 transition-all">ç¢ºèªé ç´„</button>
                                </div>
                            )}

                            {/* STEP 5: å®Œæˆ */}
                            {step === 5 && (
                                <div className="text-center pt-8 animate-fade-in-up">
                                    <div className="w-20 h-20 bg-emerald-100 rounded-full flex items-center justify-center mx-auto mb-4">
                                        <Icon name="check" size={40} className="text-emerald-600" />
                                    </div>
                                    <h2 className="text-2xl font-bold text-stone-800 mb-2">é ç´„æˆåŠŸï¼</h2>
                                    <p className="text-stone-500 text-sm mb-8">æ„Ÿè¬æ‚¨çš„é ç´„ï¼ŒæœŸå¾…èˆ‡æ‚¨åœ¨å¢Šä¸Šç›¸è¦‹ã€‚</p>

                                    <div className="bg-stone-50 p-6 rounded-2xl text-left mb-6 border border-stone-200">
                                        <div className="flex items-center mb-4">
                                            <Icon name="calendar" className="mr-3 text-emerald-500"/>
                                            <div>
                                                <h3 className="font-bold text-stone-800">12æœˆ 25æ—¥ (ä»Šæ—¥)</h3>
                                                <p className="text-emerald-600 font-bold">{selectedTime}</p>
                                            </div>
                                        </div>
                                        <div className="text-sm text-stone-500 space-y-1 pl-9 border-l-2 border-stone-200 ml-2">
                                            <p>èª²ç¨‹ï¼š{selectedService.name}</p>
                                            <p>è€å¸«ï¼š{selectedStaff.name}</p>
                                            <p>é›»è©±ï¼š{customerInfo.phone}</p>
                                        </div>
                                    </div>

                                    <a href={STORE_INFO.lineUrl} target="_blank" className="block w-full bg-[#06c755] text-white py-3 rounded-xl font-bold hover:bg-[#05b34c] transition flex items-center justify-center shadow-lg shadow-green-500/20">
                                        <span className="mr-2 text-xl">ğŸ’¬</span> åŠ å…¥ LINE æ¥æ”¶æé†’
                                    </a>
                                    <button onClick={() => window.location.reload()} className="block w-full text-stone-400 py-3 text-sm mt-2 hover:text-stone-600">è¿”å›é¦–é </button>
                                </div>
                            )}
                        </main>
                    </div>
                </div>
            );
        }

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<BookingApp />);
    </script>
</body>
</html>
